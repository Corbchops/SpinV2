<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Music Collection App</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #1e1e1e;
      color: #f0f0f0;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #333;
      padding: 1rem;
      text-align: center;
    }
    nav {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 1rem;
    }
    nav button {
      background-color: #444;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    nav button:hover {
      background-color: #666;
    }
    .tab {
      display: none;
      padding: 1rem;
      animation: fadeIn 0.3s;
    }
    .tab.active {
      display: block;
    }
    @keyframes fadeIn {
      from {opacity: 0;}
      to {opacity: 1;}
    }
    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    input, select {
      padding: 0.5rem;
      border: none;
      border-radius: 4px;
    }
    .album {
      background-color: #2b2b2b;
      padding: 1rem;
      margin-bottom: 1rem;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <header>
    <h1>ðŸŽ§ My Music Collection</h1>
  </header>
  <nav>
    <button onclick="switchTab('myCollection')">My Collection</button>
    <button onclick="switchTab('search')">Search</button>
  </nav>

  <div id="myCollection" class="tab active">
    <div class="filters">
      <select id="artistFilter" onchange="renderFilteredCollection()">
        <option value="">All Artists</option>
      </select>
      <select id="genreFilter" onchange="renderFilteredCollection()">
        <option value="">All Genres</option>
      </select>
      <select id="formatFilter" onchange="renderFilteredCollection()">
        <option value="">All Formats</option>
      </select>
      <button onclick="pickRandomAlbum()">ðŸŽ² Random Album</button>
    </div>
    <div id="collectionList"></div>
  </div>

  <div id="search" class="tab">
    <input type="text" id="searchInput" placeholder="Search albums...">
    <button onclick="searchAlbums()">Search</button>
    <div id="searchResults"></div>
  </div>

  <script>
    const collection = [];

    function switchTab(tabId) {
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.getElementById(tabId).classList.add('active');
      if (tabId === 'myCollection') renderFilteredCollection();
    }

    function renderFilteredCollection() {
      const artist = document.getElementById('artistFilter').value;
      const genre = document.getElementById('genreFilter').value;
      const format = document.getElementById('formatFilter').value;
      const filtered = collection.filter(item => {
        return (!artist || item.artist === artist) &&
               (!genre || item.genre === genre) &&
               (!format || item.format === format);
      });
      const container = document.getElementById('collectionList');
      container.innerHTML = '';
      filtered.forEach(album => {
        const div = document.createElement('div');
        div.className = 'album';
        div.innerHTML = `<strong>${album.title}</strong><br>${album.artist}<br>${album.genre} | ${album.format}`;
        container.appendChild(div);
      });
    }

    function addToCollection(album) {
      if (!collection.some(a => a.id === album.id)) {
        collection.push(album);
        updateFilters();
        renderFilteredCollection();
      }
    }

    function updateFilters() {
      const artists = [...new Set(collection.map(a => a.artist))];
      const genres = [...new Set(collection.map(a => a.genre))];
      const formats = [...new Set(collection.map(a => a.format))];
      populateFilter('artistFilter', artists);
      populateFilter('genreFilter', genres);
      populateFilter('formatFilter', formats);
    }

    function populateFilter(id, options) {
      const select = document.getElementById(id);
      const current = select.value;
      select.innerHTML = `<option value="">All</option>`;
      options.forEach(option => {
        const opt = document.createElement('option');
        opt.value = option;
        opt.textContent = option;
        if (current === option) opt.selected = true;
        select.appendChild(opt);
      });
    }

    function pickRandomAlbum() {
      const artist = document.getElementById('artistFilter').value;
      const genre = document.getElementById('genreFilter').value;
      const format = document.getElementById('formatFilter').value;
      const filtered = collection.filter(item => {
        return (!artist || item.artist === artist) &&
               (!genre || item.genre === genre) &&
               (!format || item.format === format);
      });
      if (filtered.length > 0) {
        const random = filtered[Math.floor(Math.random() * filtered.length)];
        alert(`ðŸŽ¶ ${random.title} by ${random.artist}`);
      } else {
        alert("No albums match current filters.");
      }
    }

    async function searchAlbums() {
      const query = document.getElementById('searchInput').value;
      const token = 'YOUR_DISCOGS_API_TOKEN'; // Replace with actual token if needed
      const url = `https://api.discogs.com/database/search?q=${encodeURIComponent(query)}&type=release&token=${token}`;
      const res = await fetch(url);
      const data = await res.json();
      const container = document.getElementById('searchResults');
      container.innerHTML = '';
      data.results.forEach(r => {
        const album = {
          id: r.id,
          title: r.title,
          artist: r.artist,
          genre: r.genre?.[0] || 'Unknown',
          format: r.format?.[0] || 'Unknown'
        };
        const div = document.createElement('div');
        div.className = 'album';
        div.innerHTML = `<strong>${album.title}</strong><br>${album.artist}<br>${album.genre} | ${album.format}<br><button onclick='addToCollection(${JSON.stringify(album)})'>Add to Collection</button>`;
        container.appendChild(div);
      });
    }
  </script>
</body>
</html>
